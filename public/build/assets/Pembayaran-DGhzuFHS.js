import{r as m,B as w,c as i,o as d,a as v,u as j,h as S,w as y,b as e,k as D,t as p,x as C,m as z,q as U,n as R,l as I,d as E,F as H,y as u}from"./app-Cbx_-bua.js";import{_ as L}from"./AuthenticatedLayout-icWBeFYS.js";import{_ as $}from"./ProgressBar-BDNFqPep.js";import"./ApplicationLogo-DKH-H1_m.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-CizZqq9U.js";const q={class:"py-12"},G={class:"max-w-4xl mx-auto sm:px-6 lg:px-8"},J={class:"grid grid-cols-1 lg:grid-cols-2 gap-8"},K={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},O={class:"p-6"},W={class:"space-y-4"},Y={class:"border-l-4 border-blue-500 pl-4"},Q={class:"font-semibold"},X={class:"border-l-4 border-green-500 pl-4"},Z={class:"text-xl font-bold text-green-600"},ee={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},te={class:"p-6"},ae={class:"relative"},se=["placeholder"],le={class:"mt-1"},ne={key:0,class:"text-xs text-red-500"},oe={key:1,class:"text-xs text-gray-500"},re={class:"border-2 border-dashed border-gray-300 rounded-lg p-6"},ie={class:"text-center"},de={class:"mt-4"},ue={class:"cursor-pointer"},me={key:0,class:"mt-3 p-3 bg-green-50 border border-green-200 rounded-md"},ce={class:"flex items-center"},pe={class:"ml-2 text-sm text-green-700"},fe={class:"flex items-center justify-between"},be=["disabled"],ge={key:0},ve={key:1},xe={key:0,class:"mt-8 bg-white overflow-hidden shadow-sm sm:rounded-lg"},De={__name:"Pembayaran",props:{jamaahData:{type:Object,required:!0}},setup(c){const o=c,k=o.jamaahData.expected_dp_amount||1e6,n=m({dp_amount:k,bukti_transfer:null});console.log("Form dp_amount initialized with:",k);const x=m(null),f=m(!1),P=m(null),s=m(""),r=a=>{if(!a||a===0)return"";let t=a;return typeof a=="string"&&(t=parseFloat(a.replace(/[^\d.-]/g,""))),Math.floor(t).toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")};console.log("Expected DP Amount:",o.jamaahData.expected_dp_amount),console.log("Type:",typeof o.jamaahData.expected_dp_amount),console.log("Formatted result:",r(o.jamaahData.expected_dp_amount||1e6)),console.log("Test 3000000:",r(3e6)),console.log("Test 1000000:",r(1e6)),console.log('Test "3000000":',r("3000000"));const B=o.jamaahData.expected_dp_amount||1e6,b=m(r(B));w(()=>n.value.dp_amount||o.jamaahData.expected_dp_amount||1e6);const h=w(()=>o.jamaahData.expected_dp_amount||1e6),g=a=>new Intl.NumberFormat("id-ID").format(a),M=a=>{const l=a.target.value.replace(/\D/g,"");if(l===""){b.value="",n.value.dp_amount=0;return}const V=r(l);b.value=V,n.value.dp_amount=parseInt(l),s.value&&(s.value="")},_=()=>{const a=n.value.dp_amount,t=h.value,l=1e6;return!a||a===0?(s.value="Nominal DP harus diisi",!1):a<l?(s.value=`Nominal DP tidak boleh kurang dari Rp ${g(l)}`,!1):a!==t?(s.value=`Nominal DP harus sesuai dengan yang diinputkan di pendaftaran: Rp ${g(t)}`,!1):(s.value="",!0)},F=a=>{const t=a.target.files[0];if(t){if(t.size>2*1024*1024){alert("File terlalu besar. Maksimal 2MB.");return}if(!t.type.startsWith("image/")){alert("File harus berupa gambar.");return}x.value=t,n.value.bukti_transfer=t}},N=a=>{switch(a){case"continue-registration":u.visit(route("jamaah.daftar"));break;case"pay-dp":break;case"view-payment-details":break;case"view-manasik-schedule":u.visit(route("jamaah.manasik"));break;default:console.log("Step action:",a);break}},T=a=>{switch(console.log(`üß™ Testing navigation to step ${a}`),a){case 1:u.visit(route("jamaah.daftar"));break;case 2:break;case 3:u.visit(route("jamaah.installments"));break;case 4:u.visit(route("jamaah.dashboard"));break}},A=async()=>{if(!_())return;if(!n.value.bukti_transfer){alert("Pilih file bukti transfer terlebih dahulu");return}f.value=!0;const a=new FormData;a.append("bukti_transfer",n.value.bukti_transfer),a.append("dp_amount",n.value.dp_amount),u.post(route("jamaah.pembayaran.upload"),a,{forceFormData:!0,onSuccess:t=>{console.log("Upload success:",t),alert("Bukti pembayaran berhasil diupload! Menunggu verifikasi admin."),u.visit(route("jamaah.dashboard"))},onError:t=>{console.error("Upload error:",t),console.log("Full error object:",t),alert("Gagal upload bukti transfer: "+(t.message||Object.keys(t).join(", ")||"Terjadi kesalahan"))},onFinish:()=>{f.value=!1}})};return(a,t)=>(d(),i(H,null,[v(j(S),{title:"Pembayaran DP"}),v(L,null,{header:y(()=>[...t[1]||(t[1]=[e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Pembayaran DP Umroh ",-1)])]),default:y(()=>[e("div",q,[e("div",G,[v($,{"current-step":2,"jamaah-data":c.jamaahData,onStepAction:N,onNavigateToStep:T},null,8,["jamaah-data"]),t[18]||(t[18]=e("div",{class:"mb-8"},[e("div",{class:"flex items-center justify-between"},[e("div",{class:"flex items-center text-green-600"},[e("div",{class:"flex items-center justify-center w-8 h-8 bg-green-600 rounded-full"},[e("svg",{class:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"})])]),e("span",{class:"ml-2 text-sm font-medium"},"Pendaftaran & Dokumen")]),e("div",{class:"flex-1 mx-4 h-1 bg-green-600"}),e("div",{class:"flex items-center text-blue-600"},[e("div",{class:"flex items-center justify-center w-8 h-8 bg-blue-600 rounded-full"},[e("span",{class:"text-white text-sm font-bold"},"2")]),e("span",{class:"ml-2 text-sm font-medium"},"Pembayaran DP")]),e("div",{class:"flex-1 mx-4 h-1 bg-gray-200"}),e("div",{class:"flex items-center text-gray-400"},[e("div",{class:"flex items-center justify-center w-8 h-8 bg-gray-300 rounded-full"},[e("span",{class:"text-white text-sm font-bold"},"3")]),e("span",{class:"ml-2 text-sm font-medium"},"Verifikasi & Manasik")])])],-1)),e("div",J,[e("div",K,[e("div",O,[t[7]||(t[7]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Informasi Pembayaran",-1)),e("div",W,[e("div",Y,[t[2]||(t[2]=e("p",{class:"text-sm text-gray-600"},"Paket Umroh",-1)),e("p",Q,p(c.jamaahData.paket_name||"Paket Premium"),1)]),e("div",X,[t[3]||(t[3]=e("p",{class:"text-sm text-gray-600"},"DP yang Harus Dibayar",-1)),e("p",Z,"Rp "+p(g(c.jamaahData.expected_dp_amount||1e6)),1),t[4]||(t[4]=e("p",{class:"text-xs text-gray-500"},"Sesuai dengan yang Anda inputkan di pendaftaran (minimal Rp 1.000.000)",-1))]),t[5]||(t[5]=e("div",{class:"bg-gray-50 p-4 rounded-lg"},[e("h4",{class:"font-semibold mb-2"},"Rekening Tujuan:"),e("div",{class:"space-y-2 text-sm"},[e("div",{class:"flex justify-between"},[e("span",null,"Bank:"),e("span",{class:"font-medium"},"BCA")]),e("div",{class:"flex justify-between"},[e("span",null,"No. Rekening:"),e("span",{class:"font-medium"},"1234567890")]),e("div",{class:"flex justify-between"},[e("span",null,"Atas Nama:"),e("span",{class:"font-medium"},"PT. Travel Umroh")])])],-1)),t[6]||(t[6]=e("div",{class:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},[e("div",{class:"flex"},[e("svg",{class:"w-5 h-5 text-yellow-600 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})]),e("div",{class:"ml-3"},[e("h4",{class:"text-sm font-medium text-yellow-800"},"Penting!"),e("p",{class:"text-sm text-yellow-700 mt-1"}," Transfer sesuai nominal yang tertera. Upload bukti transfer yang jelas dan lengkap. ")])])],-1))])])]),e("div",ee,[e("div",te,[t[16]||(t[16]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Upload Bukti Transfer",-1)),e("form",{onSubmit:C(A,["prevent"]),class:"space-y-6"},[e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Nominal Yang Ditransfer * ",-1)),e("div",ae,[t[8]||(t[8]=e("span",{class:"absolute left-3 top-3 text-gray-500"},"Rp",-1)),z(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>b.value=l),onInput:M,onBlur:_,type:"text",class:U(["w-full pl-12 pr-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",{"border-red-500":s.value}]),placeholder:r(h.value),required:""},null,42,se),[[R,b.value]])]),e("div",le,[s.value?(d(),i("p",ne,p(s.value),1)):(d(),i("p",oe,"Harus sesuai dengan yang diinputkan di pendaftaran: Rp "+p(g(h.value)),1))])]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Bukti Transfer * ",-1)),e("div",re,[e("div",ie,[t[12]||(t[12]=e("svg",{class:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48"},[e("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),e("div",de,[e("label",ue,[t[10]||(t[10]=e("span",{class:"mt-2 block text-sm font-medium text-gray-900"}," Upload bukti transfer ",-1)),e("input",{ref_key:"fileInput",ref:P,type:"file",class:"sr-only",accept:"image/*",onChange:F,required:""},null,544),t[11]||(t[11]=e("span",{class:"mt-1 block text-xs text-gray-500"}," PNG, JPG, JPEG up to 2MB ",-1))])])])]),x.value?(d(),i("div",me,[e("div",ce,[t[13]||(t[13]=e("svg",{class:"w-5 h-5 text-green-600",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"})],-1)),e("span",pe,p(x.value.name),1)])])):D("",!0)]),e("div",fe,[v(j(I),{href:a.route("jamaah.dashboard"),class:"text-gray-600 hover:text-gray-900"},{default:y(()=>[...t[15]||(t[15]=[E(" ‚Üê Kembali ke Dashboard ",-1)])]),_:1},8,["href"]),e("button",{type:"submit",disabled:f.value,class:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"},[f.value?(d(),i("span",ge,"Uploading...")):(d(),i("span",ve,"Konfirmasi Pembayaran"))],8,be)])],32)])])]),c.jamaahData.bukti_transfer?(d(),i("div",xe,[...t[17]||(t[17]=[e("div",{class:"p-6"},[e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Status Pembayaran"),e("div",{class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},[e("div",{class:"flex items-center"},[e("svg",{class:"w-5 h-5 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})]),e("div",{class:"ml-3"},[e("p",{class:"text-sm font-medium text-blue-800"},"Bukti transfer sudah diupload"),e("p",{class:"text-sm text-blue-600"},"Menunggu verifikasi dari admin")])])])],-1)])])):D("",!0)])])]),_:1})],64))}};export{De as default};
