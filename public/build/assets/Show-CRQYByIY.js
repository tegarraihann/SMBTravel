import{A as S,i as D,r as P,c as r,o as d,a as k,u as l,h as $,w,b as t,k as m,t as o,q as x,x as p,m as y,v as U,n as F,l as q,d as z,F as A}from"./app-Cbx_-bua.js";import{_ as J}from"./AdminLayout-m-tUBPSK.js";import"./ApplicationLogo-DKH-H1_m.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-CizZqq9U.js";const G={class:"flex items-center justify-between"},O={class:"font-semibold text-xl text-gray-800 leading-tight"},K={class:"py-12"},L={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},R={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg mb-6"},X={class:"p-6"},H={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Q={class:"mb-4"},W={class:"mt-1 text-sm text-gray-900"},Y={class:"mb-4"},Z={class:"mt-1 text-sm text-gray-900"},tt={class:"mb-4"},et={class:"mt-1 text-sm text-gray-900"},st={class:"mb-4"},at={class:"mt-1 text-sm text-gray-900"},ot={class:"mb-4"},lt={class:"mt-1 text-sm text-gray-900"},nt={class:"text-xs text-gray-500"},it={class:"mb-4"},rt={class:"mt-1 text-sm text-gray-900"},dt={class:"mb-4"},mt={class:"mb-4"},ut={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},ct={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},gt={class:"p-6"},bt={class:"flex items-center justify-between mb-4"},ft={class:"mb-6"},xt={class:"mb-4"},pt={class:"mt-1 text-sm text-gray-900"},yt={key:0,class:"text-xs text-gray-500"},ht={key:1,class:"text-xs text-gray-500"},vt={key:0,class:"mb-4"},kt={class:"mt-1 text-sm text-gray-900"},wt={class:"mb-6"},jt=["disabled"],_t={class:"mb-6"},St={key:0,class:"mb-3 p-3 bg-green-50 rounded-md"},Dt={class:"flex items-center justify-between"},Pt=["href"],Ut=["disabled"],Ft={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Nt={class:"p-6"},Ct={class:"flex items-center justify-between mb-4"},Vt={class:"mb-6"},Tt={class:"mb-4"},Et={class:"mt-1 text-sm text-gray-900"},It={key:0,class:"text-xs text-gray-500"},Bt={key:1,class:"text-xs text-gray-500"},Mt={key:0,class:"mb-4"},$t={class:"mt-1 text-sm text-gray-900"},qt={class:"mb-6"},zt=["disabled"],At={class:"mb-6"},Jt={key:0,class:"mb-3 p-3 bg-green-50 rounded-md"},Gt={class:"flex items-center justify-between"},Ot=["href"],Kt=["disabled"],Lt={key:0,class:"fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-md shadow-lg z-50"},Rt={key:1,class:"fixed top-4 right-4 bg-red-500 text-white px-6 py-3 rounded-md shadow-lg z-50"},Zt={__name:"Show",props:{jamaah:Object},setup(s){const b=s,n=S({status:"",notes:"",processing:!1}),i=S({status:"",notes:"",processing:!1}),u=D({file:null,processing:!1}),c=D({file:null,processing:!1}),h=P(null),v=P(null),N=()=>{n.status&&(n.processing=!0,n.patch(route("operasional.jamaah.ticket.status",b.jamaah.id),{onSuccess:()=>{n.reset("status","notes"),n.processing=!1},onError:()=>{n.processing=!1}}))},C=()=>{i.status&&(i.processing=!0,i.patch(route("operasional.jamaah.visa.status",b.jamaah.id),{onSuccess:()=>{i.reset("status","notes"),i.processing=!1},onError:()=>{i.processing=!1}}))},V=a=>{const e=a.target.files[0];e&&e.size<=5*1024*1024?u.file=e:(alert("File size must be less than 5MB"),a.target.value="")},T=a=>{const e=a.target.files[0];e&&e.size<=5*1024*1024?c.file=e:(alert("File size must be less than 5MB"),a.target.value="")},E=()=>{if(!u.file)return;const a=new FormData;a.append("ticket_file",u.file),u.processing=!0,fetch(route("operasional.jamaah.ticket.upload",b.jamaah.id),{method:"POST",body:a,headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""}}).then(e=>{if(!e.ok)throw new Error("Upload failed");return e.json()}).then(e=>{e.message&&(alert(e.message),u.file=null,h.value&&(h.value.value=""),location.reload())}).catch(e=>{console.error("Error:",e),alert("Upload failed: "+e.message)}).finally(()=>{u.processing=!1})},I=()=>{if(!c.file)return;const a=new FormData;a.append("visa_file",c.file),c.processing=!0,fetch(route("operasional.jamaah.visa.upload",b.jamaah.id),{method:"POST",body:a,headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""}}).then(e=>{if(!e.ok)throw new Error("Upload failed");return e.json()}).then(e=>{e.message&&(alert(e.message),c.file=null,v.value&&(v.value.value=""),location.reload())}).catch(e=>{console.error("Error:",e),alert("Upload failed: "+e.message)}).finally(()=>{c.processing=!1})},j=a=>({pending:"bg-yellow-100 text-yellow-800",processing:"bg-blue-100 text-blue-800",completed:"bg-green-100 text-green-800"})[a]||"bg-gray-100 text-gray-800",f=a=>({pending:"Pending",processing:"Processing",completed:"Completed"})[a]||"Unknown",B=a=>a?new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(a):"-",M=a=>a?new Date(a).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric"}):"-",_=a=>a?new Date(a).toLocaleString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-";return(a,e)=>(d(),r(A,null,[k(l($),{title:`Process Jamaah - ${s.jamaah?.nama_lengkap_bin_binti||"Unknown"}`},null,8,["title"]),k(J,null,{header:w(()=>[t("div",G,[t("h2",O," Process Jamaah - "+o(s.jamaah?.nama_lengkap_bin_binti||"Unknown"),1),k(l(q),{href:a.route("operasional.jamaah.index"),class:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-md text-sm"},{default:w(()=>[...e[4]||(e[4]=[z(" Back to List ",-1)])]),_:1},8,["href"])])]),default:w(()=>[t("div",K,[t("div",L,[t("div",R,[t("div",X,[e[13]||(e[13]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Jamaah Information",-1)),t("div",H,[t("div",null,[t("div",Q,[e[5]||(e[5]=t("label",{class:"block text-sm font-medium text-gray-700"},"Nama Lengkap",-1)),t("p",W,o(s.jamaah.nama_lengkap_bin_binti),1)]),t("div",Y,[e[6]||(e[6]=t("label",{class:"block text-sm font-medium text-gray-700"},"Email",-1)),t("p",Z,o(s.jamaah.user?.email),1)]),t("div",tt,[e[7]||(e[7]=t("label",{class:"block text-sm font-medium text-gray-700"},"No Telepon",-1)),t("p",et,o(s.jamaah.no_telepon),1)]),t("div",st,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium text-gray-700"},"NIK",-1)),t("p",at,o(s.jamaah.nik),1)])]),t("div",null,[t("div",ot,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-gray-700"},"Paket Umroh",-1)),t("p",lt,o(s.jamaah.umroh_package?.nama_paket),1),t("p",nt,o(B(s.jamaah.umroh_package?.harga)),1)]),t("div",it,[e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-gray-700"},"Rencana Keberangkatan",-1)),t("p",rt,o(M(s.jamaah.rencana_keberangkatan)),1)]),t("div",dt,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-gray-700"},"Status Pembayaran",-1)),t("span",{class:x([s.jamaah.payment_approved_by_admin?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800","inline-flex px-2 py-1 text-xs font-semibold rounded-full"])},o(s.jamaah.payment_approved_by_admin?"Approved":"Pending"),3)]),t("div",mt,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-gray-700"},"Status Data CS",-1)),t("span",{class:x([s.jamaah.data_approved_by_cs?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800","inline-flex px-2 py-1 text-xs font-semibold rounded-full"])},o(s.jamaah.data_approved_by_cs?"Approved":"Pending"),3)])])])])]),t("div",ut,[t("div",ct,[t("div",gt,[t("div",bt,[e[14]||(e[14]=t("h3",{class:"text-lg font-semibold text-gray-900"},"Ticket Processing",-1)),t("span",{class:x([j(s.jamaah.ticket_status),"px-3 py-1 text-sm font-semibold rounded-full"])},o(f(s.jamaah.ticket_status)),3)]),t("div",ft,[t("div",xt,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium text-gray-700"},"Current Status",-1)),t("p",pt,o(f(s.jamaah.ticket_status)),1),s.jamaah.ticket_processor?(d(),r("p",yt," Processed by: "+o(s.jamaah.ticket_processor.name),1)):m("",!0),s.jamaah.ticket_processed_at?(d(),r("p",ht,o(_(s.jamaah.ticket_processed_at)),1)):m("",!0)]),s.jamaah.ticket_notes?(d(),r("div",vt,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-700"},"Notes",-1)),t("p",kt,o(s.jamaah.ticket_notes),1)])):m("",!0)]),t("div",wt,[e[20]||(e[20]=t("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Update Status",-1)),t("form",{onSubmit:p(N,["prevent"]),class:"space-y-4"},[t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-gray-700"},"New Status",-1)),y(t("select",{"onUpdate:modelValue":e[0]||(e[0]=g=>l(n).status=g),required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200"},[...e[17]||(e[17]=[t("option",{value:""},"Select Status",-1),t("option",{value:"pending"},"Pending",-1),t("option",{value:"processing"},"Processing",-1),t("option",{value:"completed"},"Completed",-1)])],512),[[U,l(n).status]])]),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-gray-700"},"Notes",-1)),y(t("textarea",{"onUpdate:modelValue":e[1]||(e[1]=g=>l(n).notes=g),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200",placeholder:"Add processing notes..."},null,512),[[F,l(n).notes]])]),t("button",{type:"submit",disabled:l(n).processing,class:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white px-4 py-2 rounded-md text-sm"},o(l(n).processing?"Updating...":"Update Ticket Status"),9,jt)],32)]),t("div",_t,[e[24]||(e[24]=t("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Upload Ticket Document",-1)),s.jamaah.ticket_file?(d(),r("div",St,[t("div",Dt,[e[21]||(e[21]=t("span",{class:"text-sm text-green-800"},"Document uploaded",-1)),t("a",{href:`/storage/${s.jamaah.ticket_file}`,target:"_blank",class:"text-green-600 hover:text-green-800 text-sm underline"}," View Document ",8,Pt)])])):m("",!0),t("form",{onSubmit:p(E,["prevent"]),class:"space-y-4"},[t("div",null,[e[22]||(e[22]=t("label",{class:"block text-sm font-medium text-gray-700"},"Select File",-1)),t("input",{type:"file",ref_key:"ticketFileInput",ref:h,onChange:V,accept:".pdf,.jpg,.jpeg,.png",required:"",class:"mt-1 block w-full text-sm text-gray-900 border border-gray-300 rounded-md cursor-pointer bg-gray-50 focus:outline-none"},null,544),e[23]||(e[23]=t("p",{class:"text-xs text-gray-500 mt-1"},"PDF, JPG, JPEG, PNG (Max 5MB)",-1))]),t("button",{type:"submit",disabled:u.processing||!u.file,class:"w-full bg-yellow-600 hover:bg-yellow-700 disabled:bg-yellow-400 text-white px-4 py-2 rounded-md text-sm"},o(u.processing?"Uploading...":"Upload Ticket"),9,Ut)],32)])])]),t("div",Ft,[t("div",Nt,[t("div",Ct,[e[25]||(e[25]=t("h3",{class:"text-lg font-semibold text-gray-900"},"Visa Processing",-1)),t("span",{class:x([j(s.jamaah.visa_status),"px-3 py-1 text-sm font-semibold rounded-full"])},o(f(s.jamaah.visa_status)),3)]),t("div",Vt,[t("div",Tt,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium text-gray-700"},"Current Status",-1)),t("p",Et,o(f(s.jamaah.visa_status)),1),s.jamaah.visa_processor?(d(),r("p",It," Processed by: "+o(s.jamaah.visa_processor.name),1)):m("",!0),s.jamaah.visa_processed_at?(d(),r("p",Bt,o(_(s.jamaah.visa_processed_at)),1)):m("",!0)]),s.jamaah.visa_notes?(d(),r("div",Mt,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium text-gray-700"},"Notes",-1)),t("p",$t,o(s.jamaah.visa_notes),1)])):m("",!0)]),t("div",qt,[e[31]||(e[31]=t("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Update Status",-1)),t("form",{onSubmit:p(C,["prevent"]),class:"space-y-4"},[t("div",null,[e[29]||(e[29]=t("label",{class:"block text-sm font-medium text-gray-700"},"New Status",-1)),y(t("select",{"onUpdate:modelValue":e[2]||(e[2]=g=>l(i).status=g),required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200"},[...e[28]||(e[28]=[t("option",{value:""},"Select Status",-1),t("option",{value:"pending"},"Pending",-1),t("option",{value:"processing"},"Processing",-1),t("option",{value:"completed"},"Completed",-1)])],512),[[U,l(i).status]])]),t("div",null,[e[30]||(e[30]=t("label",{class:"block text-sm font-medium text-gray-700"},"Notes",-1)),y(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=g=>l(i).notes=g),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200",placeholder:"Add processing notes..."},null,512),[[F,l(i).notes]])]),t("button",{type:"submit",disabled:l(i).processing,class:"w-full bg-orange-600 hover:bg-orange-700 disabled:bg-orange-400 text-white px-4 py-2 rounded-md text-sm"},o(l(i).processing?"Updating...":"Update Visa Status"),9,zt)],32)]),t("div",At,[e[35]||(e[35]=t("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Upload Visa Document",-1)),s.jamaah.visa_file?(d(),r("div",Jt,[t("div",Gt,[e[32]||(e[32]=t("span",{class:"text-sm text-green-800"},"Document uploaded",-1)),t("a",{href:`/storage/${s.jamaah.visa_file}`,target:"_blank",class:"text-green-600 hover:text-green-800 text-sm underline"}," View Document ",8,Ot)])])):m("",!0),t("form",{onSubmit:p(I,["prevent"]),class:"space-y-4"},[t("div",null,[e[33]||(e[33]=t("label",{class:"block text-sm font-medium text-gray-700"},"Select File",-1)),t("input",{type:"file",ref_key:"visaFileInput",ref:v,onChange:T,accept:".pdf,.jpg,.jpeg,.png",required:"",class:"mt-1 block w-full text-sm text-gray-900 border border-gray-300 rounded-md cursor-pointer bg-gray-50 focus:outline-none"},null,544),e[34]||(e[34]=t("p",{class:"text-xs text-gray-500 mt-1"},"PDF, JPG, JPEG, PNG (Max 5MB)",-1))]),t("button",{type:"submit",disabled:c.processing||!c.file,class:"w-full bg-orange-600 hover:bg-orange-700 disabled:bg-orange-400 text-white px-4 py-2 rounded-md text-sm"},o(c.processing?"Uploading...":"Upload Visa"),9,Kt)],32)])])])])])]),a.$page.props.flash?.message?(d(),r("div",Lt,o(a.$page.props.flash.message),1)):m("",!0),a.$page.props.flash?.error?(d(),r("div",Rt,o(a.$page.props.flash.error),1)):m("",!0)]),_:1})],64))}};export{Zt as default};
