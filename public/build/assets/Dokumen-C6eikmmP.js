import{r as k,c as d,o as r,b as e,k as _,t as m,F,B as S,a as p,u as $,h as z,w as D,l as C,d as P,q as G,y as g}from"./app-Cbx_-bua.js";import{_ as L}from"./AuthenticatedLayout-icWBeFYS.js";import{_ as T}from"./ProgressBar-BDNFqPep.js";import"./ApplicationLogo-DKH-H1_m.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-CizZqq9U.js";const N={class:"space-y-3"},A={class:"block text-sm font-medium text-gray-700"},H={key:0,class:"bg-green-50 border border-green-200 rounded-lg p-3"},q={class:"mt-2 text-xs text-green-600"},K={class:"border-2 border-dashed border-gray-300 rounded-lg p-6 hover:border-gray-400 transition-colors"},E={class:"text-center"},I={class:"mt-4"},J={class:"cursor-pointer"},O={class:"mt-2 block text-sm font-medium text-gray-900"},W={key:1,class:"bg-blue-50 border border-blue-200 rounded-md p-3"},R={class:"flex items-center justify-between"},Q={class:"flex items-center"},X={class:"text-sm font-medium text-blue-700"},Y={class:"text-xs text-blue-600"},Z={class:"flex space-x-2"},ee=["disabled"],ae={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},te={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},le={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-3xl sm:w-full"},se={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},oe={class:"sm:flex sm:items-start"},ne={class:"mt-3 text-center sm:mt-0 sm:text-left w-full"},ie={class:"text-lg leading-6 font-medium text-gray-900 mb-4"},de={class:"mt-2"},re=["src","alt"],ue={key:1,class:"text-center py-8"},me={class:"mt-2 text-sm text-gray-600"},ce=["href"],v={__name:"DocumentUploadField",props:{modelValue:{type:File,default:null},name:{type:String,required:!0},label:{type:String,required:!0},existing:{type:Object,default:null}},emits:["update:modelValue","upload"],setup(t,{emit:o}){const b=t,f=o,c=k(null),u=k(!1),y=k(!1),x=k(null),w=i=>i?new Date(i).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"}):"",s=i=>{if(i===0)return"0 Bytes";const l=1024,V=["Bytes","KB","MB","GB"],U=Math.floor(Math.log(i)/Math.log(l));return parseFloat((i/Math.pow(l,U)).toFixed(2))+" "+V[U]},a=i=>/\.(jpg|jpeg|png|gif|bmp|webp)$/i.test(i),n=i=>{const l=i.target.files[0];if(l){if(l.size>5*1024*1024){alert("File terlalu besar. Maksimal 5MB.");return}if(!["image/jpeg","image/jpg","image/png","application/pdf"].includes(l.type)){alert("Format file tidak didukung. Gunakan JPG, PNG, atau PDF.");return}c.value=l,f("update:modelValue",l)}},h=async()=>{if(c.value){u.value=!0;try{await f("upload",b.name,c.value),c.value=null,x.value&&(x.value.value="")}catch(i){console.error("Upload failed:",i)}finally{u.value=!1}}},B=()=>{c.value=null,f("update:modelValue",null),x.value&&(x.value.value="")},M=()=>{y.value=!0},j=()=>{y.value=!1};return(i,l)=>(r(),d(F,null,[e("div",N,[e("label",A,m(t.label),1),t.existing&&t.existing.path?(r(),d("div",H,[e("div",{class:"flex items-center justify-between"},[l[0]||(l[0]=e("div",{class:"flex items-center"},[e("svg",{class:"w-5 h-5 text-green-600 mr-2",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})]),e("span",{class:"text-sm text-green-700 font-medium"},"Dokumen sudah diupload")],-1)),e("button",{onClick:M,class:"text-blue-600 hover:text-blue-800 text-sm"}," Lihat ")]),e("div",q,m(t.existing.uploaded_at?w(t.existing.uploaded_at):"Uploaded"),1)])):_("",!0),e("div",K,[e("div",E,[l[2]||(l[2]=e("svg",{class:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48"},[e("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),e("div",I,[e("label",J,[e("span",O,m(t.existing&&t.existing.path?"Upload ulang dokumen":"Upload dokumen"),1),e("input",{ref_key:"fileInput",ref:x,type:"file",class:"sr-only",accept:"image/*,.pdf",onChange:n},null,544),l[1]||(l[1]=e("span",{class:"mt-1 block text-xs text-gray-500"}," PNG, JPG, JPEG, PDF hingga 5MB ",-1))])])])]),c.value?(r(),d("div",W,[e("div",R,[e("div",Q,[l[3]||(l[3]=e("svg",{class:"w-5 h-5 text-blue-600 mr-2",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)),e("div",null,[e("p",X,m(c.value.name),1),e("p",Y,m(s(c.value.size)),1)])]),e("div",Z,[e("button",{onClick:h,disabled:u.value,class:"px-3 py-1 bg-blue-600 text-white text-xs rounded hover:bg-blue-700 disabled:opacity-50"},m(u.value?"Uploading...":"Upload"),9,ee),e("button",{onClick:B,class:"px-3 py-1 bg-gray-500 text-white text-xs rounded hover:bg-gray-600"}," Batal ")])])])):_("",!0)]),y.value?(r(),d("div",ae,[e("div",te,[e("div",{class:"fixed inset-0 transition-opacity",onClick:j},[...l[4]||(l[4]=[e("div",{class:"absolute inset-0 bg-gray-500 opacity-75"},null,-1)])]),e("div",le,[e("div",se,[e("div",oe,[e("div",ne,[e("h3",ie,m(t.label),1),e("div",de,[t.existing&&t.existing.path&&a(t.existing.path)?(r(),d("img",{key:0,src:`/storage/${t.existing.path}`,alt:t.label,class:"max-w-full h-auto rounded-lg"},null,8,re)):t.existing&&t.existing.path?(r(),d("div",ue,[l[5]||(l[5]=e("svg",{class:"mx-auto h-16 w-16 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z","clip-rule":"evenodd"})],-1)),e("p",me,m(t.label),1),e("a",{href:`/storage/${t.existing.path}`,target:"_blank",class:"mt-2 inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-blue-700 bg-blue-100 hover:bg-blue-200"}," Download & Lihat File ",8,ce)])):_("",!0)])])])]),e("div",{class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},[e("button",{type:"button",onClick:j,class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm"}," Tutup ")])])])])):_("",!0)],64))}},pe={class:"py-12"},ge={class:"max-w-4xl mx-auto sm:px-6 lg:px-8"},fe={key:0,class:"bg-yellow-50 border border-yellow-200 rounded-lg p-6 mb-6"},be={key:1},xe={class:"bg-white shadow rounded-lg mb-6"},he={class:"p-6"},ve={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ke={class:"bg-white shadow rounded-lg mb-6"},ye={class:"p-6"},_e={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},we={class:"flex items-center justify-between"},De=["disabled"],je={key:0},Ve={key:1},Ue={key:0,class:"mt-6 bg-green-50 border border-green-200 rounded-lg p-4"},$e={class:"flex items-center"},Fe={class:"ml-3"},Be={class:"text-sm text-green-600"},Le={__name:"Dokumen",props:{jamaahData:{type:Object,required:!0}},setup(t){const o=k({foto_ktp:null,foto_kk:null,foto_diri:null,foto_paspor:null,scan_buku_nikah:null,scan_akta_lahir:null}),b=k(!1),f=S(()=>o.value.foto_ktp&&o.value.foto_kk&&o.value.foto_diri&&o.value.foto_paspor),c=s=>s?new Date(s).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",u=async(s,a)=>{if(!a)return;const n=new FormData;n.append("document_type",s),n.append("document_file",a);try{await g.post(route("jamaah.dokumen.upload"),n,{forceFormData:!0,preserveState:!0,onSuccess:()=>{console.log(`${s} uploaded successfully`)},onError:h=>{console.error("Upload error:",h),alert("Gagal upload dokumen: "+(h.message||"Terjadi kesalahan"))}})}catch(h){console.error("Upload error:",h),alert("Gagal upload dokumen")}},y=async()=>{if(!f.value){alert("Harap upload semua dokumen wajib terlebih dahulu");return}b.value=!0;try{await g.post(route("jamaah.dokumen.complete"),{},{onSuccess:()=>{alert("Semua dokumen berhasil diupload! Menunggu verifikasi admin."),g.visit(route("jamaah.dashboard"))},onError:s=>{console.error("Complete error:",s),alert("Gagal menyelesaikan upload dokumen: "+(s.message||"Terjadi kesalahan"))}})}catch(s){console.error("Complete error:",s),alert("Gagal menyelesaikan upload dokumen")}finally{b.value=!1}},x=s=>{switch(s){case"continue-registration":g.visit(route("jamaah.daftar"));break;case"pay-dp":g.visit(route("jamaah.pembayaran"));break;case"upload-documents":break;case"view-manasik-schedule":g.visit(route("jamaah.manasik"));break;case"check-verification-status":break;default:console.log("Step action:",s);break}},w=s=>{switch(console.log(`🧪 Testing navigation to step ${s}`),s){case 1:g.visit(route("jamaah.daftar"));break;case 2:g.visit(route("jamaah.pembayaran"));break;case 3:g.visit(route("jamaah.installments"));break;case 4:g.visit(route("jamaah.dashboard"));break}};return(s,a)=>(r(),d(F,null,[p($(z),{title:"Upload Dokumen"}),p(L,null,{header:D(()=>[...a[6]||(a[6]=[e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Upload Dokumen Persyaratan ",-1)])]),default:D(()=>[e("div",pe,[e("div",ge,[p(T,{"current-step":t.jamaahData.current_step,"jamaah-data":t.jamaahData,onStepAction:x,onNavigateToStep:w},null,8,["current-step","jamaah-data"]),t.jamaahData.can_upload_documents?(r(),d("div",be,[a[13]||(a[13]=e("div",{class:"bg-blue-50 border border-blue-200 rounded-lg p-6 mb-6"},[e("h3",{class:"text-lg font-semibold text-blue-900 mb-3"},"Petunjuk Upload Dokumen"),e("ul",{class:"space-y-2 text-blue-800"},[e("li",{class:"flex items-start"},[e("span",{class:"text-blue-600 mr-2"},"•"),e("span",null,"Upload semua dokumen yang diperlukan dalam format JPG, PNG, atau PDF")]),e("li",{class:"flex items-start"},[e("span",{class:"text-blue-600 mr-2"},"•"),e("span",null,"Ukuran maksimal setiap file adalah 5MB")]),e("li",{class:"flex items-start"},[e("span",{class:"text-blue-600 mr-2"},"•"),e("span",null,"Pastikan foto/scan jelas dan dapat dibaca")]),e("li",{class:"flex items-start"},[e("span",{class:"text-blue-600 mr-2"},"•"),e("span",null,"Dokumen dengan tanda bintang (*) wajib diupload")])])],-1)),e("div",xe,[a[8]||(a[8]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Dokumen Wajib")],-1)),e("div",he,[e("div",ve,[p(v,{modelValue:o.value.foto_ktp,"onUpdate:modelValue":a[0]||(a[0]=n=>o.value.foto_ktp=n),name:"foto_ktp",label:"Foto KTP *",existing:t.jamaahData.documents.foto_ktp,onUpload:u},null,8,["modelValue","existing"]),p(v,{modelValue:o.value.foto_kk,"onUpdate:modelValue":a[1]||(a[1]=n=>o.value.foto_kk=n),name:"foto_kk",label:"Foto Kartu Keluarga *",existing:t.jamaahData.documents.foto_kk,onUpload:u},null,8,["modelValue","existing"]),p(v,{modelValue:o.value.foto_diri,"onUpdate:modelValue":a[2]||(a[2]=n=>o.value.foto_diri=n),name:"foto_diri",label:"Foto Diri *",existing:t.jamaahData.documents.foto_diri,onUpload:u},null,8,["modelValue","existing"]),p(v,{modelValue:o.value.foto_paspor,"onUpdate:modelValue":a[3]||(a[3]=n=>o.value.foto_paspor=n),name:"foto_paspor",label:"Foto Paspor *",existing:t.jamaahData.documents.foto_paspor,onUpload:u},null,8,["modelValue","existing"])])])]),e("div",ke,[a[9]||(a[9]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Dokumen Opsional"),e("p",{class:"text-sm text-gray-600"},"Upload jika tersedia")],-1)),e("div",ye,[e("div",_e,[p(v,{modelValue:o.value.scan_buku_nikah,"onUpdate:modelValue":a[4]||(a[4]=n=>o.value.scan_buku_nikah=n),name:"scan_buku_nikah",label:"Scan Buku Nikah",existing:t.jamaahData.documents.scan_buku_nikah,onUpload:u},null,8,["modelValue","existing"]),p(v,{modelValue:o.value.scan_akta_lahir,"onUpdate:modelValue":a[5]||(a[5]=n=>o.value.scan_akta_lahir=n),name:"scan_akta_lahir",label:"Scan Akta Lahir",existing:t.jamaahData.documents.scan_akta_lahir,onUpload:u},null,8,["modelValue","existing"])])])]),e("div",we,[p($(C),{href:s.route("jamaah.dashboard"),class:"text-gray-600 hover:text-gray-900"},{default:D(()=>[...a[10]||(a[10]=[P(" ← Kembali ke Dashboard ",-1)])]),_:1},8,["href"]),e("button",{onClick:y,disabled:b.value||!f.value,class:G(["px-6 py-3 rounded-md font-medium focus:ring-2 focus:ring-blue-500",f.value&&!b.value?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-300 text-gray-500 cursor-not-allowed"])},[b.value?(r(),d("span",je,"Menyimpan...")):(r(),d("span",Ve,m(f.value?"Selesai Upload Dokumen":"Upload Dokumen Wajib Dulu"),1))],10,De)]),t.jamaahData.documents_uploaded_at?(r(),d("div",Ue,[e("div",$e,[a[12]||(a[12]=e("svg",{class:"w-5 h-5 text-green-600",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})],-1)),e("div",Fe,[a[11]||(a[11]=e("p",{class:"text-sm font-medium text-green-800"},"Dokumen sudah diupload",-1)),e("p",Be," Uploaded pada: "+m(c(t.jamaahData.documents_uploaded_at))+" "+m(t.jamaahData.documents_verified?"• Sudah diverifikasi":"• Menunggu verifikasi"),1)])])])):_("",!0)])):(r(),d("div",fe,[...a[7]||(a[7]=[e("div",{class:"flex"},[e("svg",{class:"w-6 h-6 text-yellow-600 mt-1",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})]),e("div",{class:"ml-3"},[e("h3",{class:"text-lg font-medium text-yellow-800"},"Akses Tidak Tersedia"),e("p",{class:"text-yellow-700 mt-1"}," Anda belum bisa upload dokumen. Pastikan pembayaran DP sudah diverifikasi oleh admin. ")])],-1)])]))])])]),_:1})],64))}};export{Le as default};
