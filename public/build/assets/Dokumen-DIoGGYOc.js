import{r as b,c as d,o as r,b as e,i as k,t as m,F as U,z as F,a as f,u as V,h as C,w as y,l as P,d as L,n as S,s as w}from"./app-DuLUwTU_.js";import{_ as G}from"./AuthenticatedLayout-SV__XKGo.js";import"./ApplicationLogo-uq9fm9QF.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-ByflGO8O.js";const T={class:"space-y-3"},H={class:"block text-sm font-medium text-gray-700"},N={key:0,class:"bg-green-50 border border-green-200 rounded-lg p-3"},A={class:"mt-2 text-xs text-green-600"},I={class:"border-2 border-dashed border-gray-300 rounded-lg p-6 hover:border-gray-400 transition-colors"},K={class:"text-center"},q={class:"mt-4"},E={class:"cursor-pointer"},J={class:"mt-2 block text-sm font-medium text-gray-900"},O={key:1,class:"bg-blue-50 border border-blue-200 rounded-md p-3"},W={class:"flex items-center justify-between"},R={class:"flex items-center"},Q={class:"text-sm font-medium text-blue-700"},X={class:"text-xs text-blue-600"},Y={class:"flex space-x-2"},Z=["disabled"],ee={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},te={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},ae={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-3xl sm:w-full"},le={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},se={class:"sm:flex sm:items-start"},oe={class:"mt-3 text-center sm:mt-0 sm:text-left w-full"},ne={class:"text-lg leading-6 font-medium text-gray-900 mb-4"},ie={class:"mt-2"},de=["src","alt"],re={key:1,class:"text-center py-8"},ue={class:"mt-2 text-sm text-gray-600"},me=["href"],v={__name:"DocumentUploadField",props:{modelValue:{type:File,default:null},name:{type:String,required:!0},label:{type:String,required:!0},existing:{type:Object,default:null}},emits:["update:modelValue","upload"],setup(a,{emit:s}){const p=a,g=s,c=b(null),u=b(!1),h=b(!1),o=b(null),t=i=>i?new Date(i).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"}):"",n=i=>{if(i===0)return"0 Bytes";const l=1024,D=["Bytes","KB","MB","GB"],j=Math.floor(Math.log(i)/Math.log(l));return parseFloat((i/Math.pow(l,j)).toFixed(2))+" "+D[j]},x=i=>/\.(jpg|jpeg|png|gif|bmp|webp)$/i.test(i),$=i=>{const l=i.target.files[0];if(l){if(l.size>5*1024*1024){alert("File terlalu besar. Maksimal 5MB.");return}if(!["image/jpeg","image/jpg","image/png","application/pdf"].includes(l.type)){alert("Format file tidak didukung. Gunakan JPG, PNG, atau PDF.");return}c.value=l,g("update:modelValue",l)}},M=async()=>{if(c.value){u.value=!0;try{await g("upload",p.name,c.value),c.value=null,o.value&&(o.value.value="")}catch(i){console.error("Upload failed:",i)}finally{u.value=!1}}},z=()=>{c.value=null,g("update:modelValue",null),o.value&&(o.value.value="")},B=()=>{h.value=!0},_=()=>{h.value=!1};return(i,l)=>(r(),d(U,null,[e("div",T,[e("label",H,m(a.label),1),a.existing&&a.existing.path?(r(),d("div",N,[e("div",{class:"flex items-center justify-between"},[l[0]||(l[0]=e("div",{class:"flex items-center"},[e("svg",{class:"w-5 h-5 text-green-600 mr-2",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})]),e("span",{class:"text-sm text-green-700 font-medium"},"Dokumen sudah diupload")],-1)),e("button",{onClick:B,class:"text-blue-600 hover:text-blue-800 text-sm"}," Lihat ")]),e("div",A,m(a.existing.uploaded_at?t(a.existing.uploaded_at):"Uploaded"),1)])):k("",!0),e("div",I,[e("div",K,[l[2]||(l[2]=e("svg",{class:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48"},[e("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),e("div",q,[e("label",E,[e("span",J,m(a.existing&&a.existing.path?"Upload ulang dokumen":"Upload dokumen"),1),e("input",{ref_key:"fileInput",ref:o,type:"file",class:"sr-only",accept:"image/*,.pdf",onChange:$},null,544),l[1]||(l[1]=e("span",{class:"mt-1 block text-xs text-gray-500"}," PNG, JPG, JPEG, PDF hingga 5MB ",-1))])])])]),c.value?(r(),d("div",O,[e("div",W,[e("div",R,[l[3]||(l[3]=e("svg",{class:"w-5 h-5 text-blue-600 mr-2",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)),e("div",null,[e("p",Q,m(c.value.name),1),e("p",X,m(n(c.value.size)),1)])]),e("div",Y,[e("button",{onClick:M,disabled:u.value,class:"px-3 py-1 bg-blue-600 text-white text-xs rounded hover:bg-blue-700 disabled:opacity-50"},m(u.value?"Uploading...":"Upload"),9,Z),e("button",{onClick:z,class:"px-3 py-1 bg-gray-500 text-white text-xs rounded hover:bg-gray-600"}," Batal ")])])])):k("",!0)]),h.value?(r(),d("div",ee,[e("div",te,[e("div",{class:"fixed inset-0 transition-opacity",onClick:_},[...l[4]||(l[4]=[e("div",{class:"absolute inset-0 bg-gray-500 opacity-75"},null,-1)])]),e("div",ae,[e("div",le,[e("div",se,[e("div",oe,[e("h3",ne,m(a.label),1),e("div",ie,[a.existing&&a.existing.path&&x(a.existing.path)?(r(),d("img",{key:0,src:`/storage/${a.existing.path}`,alt:a.label,class:"max-w-full h-auto rounded-lg"},null,8,de)):a.existing&&a.existing.path?(r(),d("div",re,[l[5]||(l[5]=e("svg",{class:"mx-auto h-16 w-16 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z","clip-rule":"evenodd"})],-1)),e("p",ue,m(a.label),1),e("a",{href:`/storage/${a.existing.path}`,target:"_blank",class:"mt-2 inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-blue-700 bg-blue-100 hover:bg-blue-200"}," Download & Lihat File ",8,me)])):k("",!0)])])])]),e("div",{class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},[e("button",{type:"button",onClick:_,class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm"}," Tutup ")])])])])):k("",!0)],64))}},ce={class:"py-12"},fe={class:"max-w-4xl mx-auto sm:px-6 lg:px-8"},ge={key:0,class:"bg-yellow-50 border border-yellow-200 rounded-lg p-6 mb-6"},pe={key:1},xe={class:"bg-white shadow rounded-lg mb-6"},ve={class:"p-6"},be={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},he={class:"bg-white shadow rounded-lg mb-6"},ke={class:"p-6"},ye={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},we={class:"flex items-center justify-between"},_e=["disabled"],De={key:0},je={key:1},Ve={key:0,class:"mt-6 bg-green-50 border border-green-200 rounded-lg p-4"},Ue={class:"flex items-center"},$e={class:"ml-3"},Me={class:"text-sm text-green-600"},Le={__name:"Dokumen",props:{jamaahData:{type:Object,required:!0}},setup(a){const s=b({foto_ktp:null,foto_kk:null,foto_diri:null,foto_paspor:null,scan_buku_nikah:null,scan_akta_lahir:null}),p=b(!1),g=F(()=>s.value.foto_ktp&&s.value.foto_kk&&s.value.foto_diri&&s.value.foto_paspor),c=o=>o?new Date(o).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",u=async(o,t)=>{if(!t)return;const n=new FormData;n.append("document_type",o),n.append("document_file",t);try{await w.post(route("jamaah.dokumen.upload"),n,{forceFormData:!0,preserveState:!0,onSuccess:()=>{console.log(`${o} uploaded successfully`)},onError:x=>{console.error("Upload error:",x),alert("Gagal upload dokumen: "+(x.message||"Terjadi kesalahan"))}})}catch(x){console.error("Upload error:",x),alert("Gagal upload dokumen")}},h=async()=>{if(!g.value){alert("Harap upload semua dokumen wajib terlebih dahulu");return}p.value=!0;try{await w.post(route("jamaah.dokumen.complete"),{},{onSuccess:()=>{alert("Semua dokumen berhasil diupload! Menunggu verifikasi admin."),w.visit(route("jamaah.dashboard"))},onError:o=>{console.error("Complete error:",o),alert("Gagal menyelesaikan upload dokumen: "+(o.message||"Terjadi kesalahan"))}})}catch(o){console.error("Complete error:",o),alert("Gagal menyelesaikan upload dokumen")}finally{p.value=!1}};return(o,t)=>(r(),d(U,null,[f(V(C),{title:"Upload Dokumen"}),f(G,null,{header:y(()=>[...t[6]||(t[6]=[e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Upload Dokumen Persyaratan ",-1)])]),default:y(()=>[e("div",ce,[e("div",fe,[t[14]||(t[14]=e("div",{class:"mb-8"},[e("div",{class:"flex items-center justify-between"},[e("div",{class:"flex items-center text-green-600"},[e("div",{class:"flex items-center justify-center w-8 h-8 bg-green-600 rounded-full"},[e("svg",{class:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"})])]),e("span",{class:"ml-2 text-sm font-medium"},"Data Diri")]),e("div",{class:"flex-1 mx-4 h-1 bg-green-600"}),e("div",{class:"flex items-center text-green-600"},[e("div",{class:"flex items-center justify-center w-8 h-8 bg-green-600 rounded-full"},[e("svg",{class:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"})])]),e("span",{class:"ml-2 text-sm font-medium"},"Pembayaran")]),e("div",{class:"flex-1 mx-4 h-1 bg-green-600"}),e("div",{class:"flex items-center text-green-600"},[e("div",{class:"flex items-center justify-center w-8 h-8 bg-green-600 rounded-full"},[e("svg",{class:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"})])]),e("span",{class:"ml-2 text-sm font-medium"},"Verifikasi")]),e("div",{class:"flex-1 mx-4 h-1 bg-blue-600"}),e("div",{class:"flex items-center text-blue-600"},[e("div",{class:"flex items-center justify-center w-8 h-8 bg-blue-600 rounded-full"},[e("span",{class:"text-white text-sm font-bold"},"4")]),e("span",{class:"ml-2 text-sm font-medium"},"Upload Dokumen")])])],-1)),a.jamaahData.can_upload_documents?(r(),d("div",pe,[t[13]||(t[13]=e("div",{class:"bg-blue-50 border border-blue-200 rounded-lg p-6 mb-6"},[e("h3",{class:"text-lg font-semibold text-blue-900 mb-3"},"Petunjuk Upload Dokumen"),e("ul",{class:"space-y-2 text-blue-800"},[e("li",{class:"flex items-start"},[e("span",{class:"text-blue-600 mr-2"},"•"),e("span",null,"Upload semua dokumen yang diperlukan dalam format JPG, PNG, atau PDF")]),e("li",{class:"flex items-start"},[e("span",{class:"text-blue-600 mr-2"},"•"),e("span",null,"Ukuran maksimal setiap file adalah 5MB")]),e("li",{class:"flex items-start"},[e("span",{class:"text-blue-600 mr-2"},"•"),e("span",null,"Pastikan foto/scan jelas dan dapat dibaca")]),e("li",{class:"flex items-start"},[e("span",{class:"text-blue-600 mr-2"},"•"),e("span",null,"Dokumen dengan tanda bintang (*) wajib diupload")])])],-1)),e("div",xe,[t[8]||(t[8]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Dokumen Wajib")],-1)),e("div",ve,[e("div",be,[f(v,{modelValue:s.value.foto_ktp,"onUpdate:modelValue":t[0]||(t[0]=n=>s.value.foto_ktp=n),name:"foto_ktp",label:"Foto KTP *",existing:a.jamaahData.documents.foto_ktp,onUpload:u},null,8,["modelValue","existing"]),f(v,{modelValue:s.value.foto_kk,"onUpdate:modelValue":t[1]||(t[1]=n=>s.value.foto_kk=n),name:"foto_kk",label:"Foto Kartu Keluarga *",existing:a.jamaahData.documents.foto_kk,onUpload:u},null,8,["modelValue","existing"]),f(v,{modelValue:s.value.foto_diri,"onUpdate:modelValue":t[2]||(t[2]=n=>s.value.foto_diri=n),name:"foto_diri",label:"Foto Diri *",existing:a.jamaahData.documents.foto_diri,onUpload:u},null,8,["modelValue","existing"]),f(v,{modelValue:s.value.foto_paspor,"onUpdate:modelValue":t[3]||(t[3]=n=>s.value.foto_paspor=n),name:"foto_paspor",label:"Foto Paspor *",existing:a.jamaahData.documents.foto_paspor,onUpload:u},null,8,["modelValue","existing"])])])]),e("div",he,[t[9]||(t[9]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Dokumen Opsional"),e("p",{class:"text-sm text-gray-600"},"Upload jika tersedia")],-1)),e("div",ke,[e("div",ye,[f(v,{modelValue:s.value.scan_buku_nikah,"onUpdate:modelValue":t[4]||(t[4]=n=>s.value.scan_buku_nikah=n),name:"scan_buku_nikah",label:"Scan Buku Nikah",existing:a.jamaahData.documents.scan_buku_nikah,onUpload:u},null,8,["modelValue","existing"]),f(v,{modelValue:s.value.scan_akta_lahir,"onUpdate:modelValue":t[5]||(t[5]=n=>s.value.scan_akta_lahir=n),name:"scan_akta_lahir",label:"Scan Akta Lahir",existing:a.jamaahData.documents.scan_akta_lahir,onUpload:u},null,8,["modelValue","existing"])])])]),e("div",we,[f(V(P),{href:o.route("jamaah.dashboard"),class:"text-gray-600 hover:text-gray-900"},{default:y(()=>[...t[10]||(t[10]=[L(" ← Kembali ke Dashboard ",-1)])]),_:1},8,["href"]),e("button",{onClick:h,disabled:p.value||!g.value,class:S(["px-6 py-3 rounded-md font-medium focus:ring-2 focus:ring-blue-500",g.value&&!p.value?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-300 text-gray-500 cursor-not-allowed"])},[p.value?(r(),d("span",De,"Menyimpan...")):(r(),d("span",je,m(g.value?"Selesai Upload Dokumen":"Upload Dokumen Wajib Dulu"),1))],10,_e)]),a.jamaahData.documents_uploaded_at?(r(),d("div",Ve,[e("div",Ue,[t[12]||(t[12]=e("svg",{class:"w-5 h-5 text-green-600",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})],-1)),e("div",$e,[t[11]||(t[11]=e("p",{class:"text-sm font-medium text-green-800"},"Dokumen sudah diupload",-1)),e("p",Me," Uploaded pada: "+m(c(a.jamaahData.documents_uploaded_at))+" "+m(a.jamaahData.documents_verified?"• Sudah diverifikasi":"• Menunggu verifikasi"),1)])])])):k("",!0)])):(r(),d("div",ge,[...t[7]||(t[7]=[e("div",{class:"flex"},[e("svg",{class:"w-6 h-6 text-yellow-600 mt-1",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})]),e("div",{class:"ml-3"},[e("h3",{class:"text-lg font-medium text-yellow-800"},"Akses Tidak Tersedia"),e("p",{class:"text-yellow-700 mt-1"}," Anda belum bisa upload dokumen. Pastikan pembayaran DP sudah diverifikasi oleh admin. ")])],-1)])]))])])]),_:1})],64))}};export{Le as default};
