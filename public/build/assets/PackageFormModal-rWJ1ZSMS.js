import{r as h,B as F,D as $,C as U,c as n,k as g,o as r,b as e,t as d,x as E,m as u,d as p,n as b,v as w,F as x,e as y}from"./app-Cbx_-bua.js";const P={key:0,class:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},q={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},J={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-6xl sm:w-full"},I={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},z={class:"sm:flex sm:items-start"},A={class:"w-full"},H={class:"flex items-center justify-between mb-4"},O={class:"text-lg leading-6 font-medium text-gray-900",id:"modal-title"},L={class:"bg-gray-50 p-4 rounded-lg"},R={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},G={class:"sm:col-span-2"},K={key:0,class:"text-red-500 text-sm mt-1"},Y={key:0,class:"text-red-500 text-sm mt-1"},Q={key:0,class:"text-red-500 text-sm mt-1"},W={key:0,class:"text-red-500 text-sm mt-1"},X={class:"sm:col-span-2"},Z={key:0,class:"text-red-500 text-sm mt-1"},ee={class:"bg-gray-50 p-4 rounded-lg"},te={class:"space-y-3"},ae={class:"w-24 text-sm text-gray-600 capitalize"},se=["onUpdate:modelValue","placeholder"],le={class:"bg-blue-50 border border-blue-200 p-4 rounded-lg"},oe={key:0,class:"text-center py-6 text-gray-500"},ne={key:1,class:"space-y-4"},re={class:"flex items-start justify-between mb-3"},ie={class:"flex-1"},de={class:"font-medium text-gray-900 mb-2"},ue={class:"grid grid-cols-2 lg:grid-cols-4 gap-3"},me=["onUpdate:modelValue"],be=["value"],ce=["onUpdate:modelValue"],ge=["value"],pe=["onUpdate:modelValue"],ve=["onUpdate:modelValue"],fe={class:"mt-3 grid grid-cols-1 lg:grid-cols-2 gap-3"},ke=["onUpdate:modelValue"],xe={class:"text-sm bg-gray-50 px-3 py-2 rounded-md"},ye={class:"mt-3"},he=["onUpdate:modelValue"],we=["onClick"],_e={class:"flex items-center justify-end space-x-3 pt-4 border-t border-gray-200"},Ve=["disabled"],Ue={key:0},De={key:1},Be={__name:"PackageFormModal",props:{show:Boolean,packageData:Object},emits:["close","save"],setup(_,{emit:D}){const v=_,M=D,f=h(!1),i=h({}),k={nama_paket:"",deskripsi:"",harga:"",durasi_hari:"",status:"aktif",fasilitas:{hotel:"",transportasi:"",makan:"",pemandu:"",visa:"",ziarah:""},schedules:[]},l=h({...k}),c=F(()=>!!v.packageData);$(()=>v.packageData,async s=>{if(s){if(l.value={...k,...s,fasilitas:{...k.fasilitas,...s.fasilitas||{}},schedules:[]},c.value)try{const t=await U.get(`/api/admin/packages/${s.id}/schedules`);t.data.success&&(l.value.schedules=t.data.data.map(a=>({id:a.id,tahun:a.tahun,bulan:a.bulan,tanggal_keberangkatan:a.tanggal_keberangkatan,kuota:a.kuota,biaya_tambahan:a.biaya_tambahan||0,catatan:a.catatan||""})))}catch(t){console.error("Error loading schedules for edit:",t),l.value.schedules=[]}}else l.value={...k};i.value={}},{immediate:!0});const B=async()=>{try{f.value=!0,i.value={};const s=c.value?`/api/admin/packages/${v.packageData.id}`:"/api/admin/packages",t=c.value?"put":"post";console.log("=== FRONTEND DEBUG ==="),console.log("Endpoint:",s),console.log("Method:",t),console.log("Form Data:",JSON.stringify(l.value,null,2)),console.log("Is Editing:",c.value),console.log("Package Data:",v.packageData),console.log("======================"),(await U[t](s,l.value)).data.success&&M("save")}catch(s){s.response?.status===422?i.value=s.response.data.errors||{}:(console.error("Error saving package:",s),alert("Gagal menyimpan paket"))}finally{f.value=!1}},C={1:"Januari",2:"Februari",3:"Maret",4:"April",5:"Mei",6:"Juni",7:"Juli",8:"Agustus",9:"September",10:"Oktober",11:"November",12:"Desember"},N=[2024,2025,2026,2027],T=()=>{l.value.schedules.push({tahun:new Date().getFullYear(),bulan:"",tanggal_keberangkatan:"",kuota:40,biaya_tambahan:0,catatan:""})},j=s=>{l.value.schedules.splice(s,1)},S=s=>{if(!s.tahun||!s.bulan||!s.tanggal_keberangkatan)return"Pilih tanggal lengkap";try{const t=new Date(s.tahun,s.bulan-1,s.tanggal_keberangkatan);return isNaN(t.getTime())?"Tanggal tidak valid":t.toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}catch{return"Tanggal tidak valid"}};return(s,t)=>_.show?(r(),n("div",P,[e("div",q,[e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:t[0]||(t[0]=a=>s.$emit("close"))}),t[30]||(t[30]=e("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"â€‹",-1)),e("div",J,[e("div",I,[e("div",z,[e("div",A,[e("div",H,[e("h3",O,d(c.value?"Edit Paket Umroh":"Tambah Paket Umroh"),1),e("button",{onClick:t[1]||(t[1]=a=>s.$emit("close")),class:"text-gray-400 hover:text-gray-600"},[...t[8]||(t[8]=[e("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("form",{onSubmit:E(B,["prevent"]),class:"space-y-6"},[e("div",L,[t[15]||(t[15]=e("h4",{class:"text-md font-medium text-gray-900 mb-4"},"Informasi Paket",-1)),e("div",R,[e("div",G,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700"},[p(" Nama Paket "),e("span",{class:"text-red-500"},"*")],-1)),u(e("input",{"onUpdate:modelValue":t[2]||(t[2]=a=>l.value.nama_paket=a),type:"text",required:"",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Masukkan nama paket"},null,512),[[b,l.value.nama_paket]]),i.value.nama_paket?(r(),n("div",K,d(i.value.nama_paket[0]),1)):g("",!0)]),e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700"},[p(" Harga (IDR) "),e("span",{class:"text-red-500"},"*")],-1)),u(e("input",{"onUpdate:modelValue":t[3]||(t[3]=a=>l.value.harga=a),type:"number",required:"",min:"0",step:"1000",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"25000000"},null,512),[[b,l.value.harga,void 0,{number:!0}]]),i.value.harga?(r(),n("div",Y,d(i.value.harga[0]),1)):g("",!0)]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700"},[p(" Durasi (Hari) "),e("span",{class:"text-red-500"},"*")],-1)),u(e("input",{"onUpdate:modelValue":t[4]||(t[4]=a=>l.value.durasi_hari=a),type:"number",required:"",min:"1",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"12"},null,512),[[b,l.value.durasi_hari,void 0,{number:!0}]]),i.value.durasi_hari?(r(),n("div",Q,d(i.value.durasi_hari[0]),1)):g("",!0)]),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700"},[p(" Status "),e("span",{class:"text-red-500"},"*")],-1)),u(e("select",{"onUpdate:modelValue":t[5]||(t[5]=a=>l.value.status=a),required:"",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm"},[...t[12]||(t[12]=[e("option",{value:"aktif"},"Aktif",-1),e("option",{value:"non_aktif"},"Non Aktif",-1)])],512),[[w,l.value.status]]),i.value.status?(r(),n("div",W,d(i.value.status[0]),1)):g("",!0)]),e("div",X,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700"}," Deskripsi ",-1)),u(e("textarea",{"onUpdate:modelValue":t[6]||(t[6]=a=>l.value.deskripsi=a),rows:"3",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Deskripsi paket umroh..."},null,512),[[b,l.value.deskripsi]]),i.value.deskripsi?(r(),n("div",Z,d(i.value.deskripsi[0]),1)):g("",!0)])])]),e("div",ee,[t[16]||(t[16]=e("h4",{class:"text-md font-medium text-gray-900 mb-4"},"Fasilitas",-1)),e("div",te,[(r(!0),n(x,null,y(l.value.fasilitas,(a,m)=>(r(),n("div",{key:m,class:"flex items-center space-x-3"},[e("label",ae,d(m.replace("_"," "))+":",1),u(e("input",{"onUpdate:modelValue":o=>l.value.fasilitas[m]=o,type:"text",class:"flex-1 border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:`Fasilitas ${m.replace("_"," ")}`},null,8,se),[[b,l.value.fasilitas[m]]])]))),128))])]),e("div",le,[e("div",{class:"flex items-center justify-between mb-4"},[t[18]||(t[18]=e("h4",{class:"text-md font-medium text-blue-900"},"Jadwal Keberangkatan",-1)),e("button",{type:"button",onClick:T,class:"flex items-center px-3 py-1.5 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700"},[...t[17]||(t[17]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),p(" Tambah Jadwal ",-1)])])]),l.value.schedules.length===0?(r(),n("div",oe,[...t[19]||(t[19]=[e("svg",{class:"mx-auto h-8 w-8 text-gray-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2-2v12a2 2 0 002 2z"})],-1),e("p",null,"Belum ada jadwal keberangkatan",-1)])])):(r(),n("div",ne,[(r(!0),n(x,null,y(l.value.schedules,(a,m)=>(r(),n("div",{key:m,class:"bg-white p-4 rounded-lg border border-blue-200"},[e("div",re,[e("div",ie,[e("h5",de,"Jadwal "+d(m+1),1),e("div",ue,[e("div",null,[t[21]||(t[21]=e("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"Tahun",-1)),u(e("select",{"onUpdate:modelValue":o=>a.tahun=o,required:"",class:"block w-full text-sm border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"},[t[20]||(t[20]=e("option",{value:""},"Pilih Tahun",-1)),(r(),n(x,null,y(N,o=>e("option",{key:o,value:o},d(o),9,be)),64))],8,me),[[w,a.tahun,void 0,{number:!0}]])]),e("div",null,[t[23]||(t[23]=e("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"Bulan",-1)),u(e("select",{"onUpdate:modelValue":o=>a.bulan=o,required:"",class:"block w-full text-sm border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"},[t[22]||(t[22]=e("option",{value:""},"Pilih Bulan",-1)),(r(),n(x,null,y(C,(o,V)=>e("option",{key:V,value:parseInt(V)},d(o),9,ge)),64))],8,ce),[[w,a.bulan,void 0,{number:!0}]])]),e("div",null,[t[24]||(t[24]=e("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"Tanggal",-1)),u(e("input",{"onUpdate:modelValue":o=>a.tanggal_keberangkatan=o,type:"number",required:"",min:"1",max:"31",placeholder:"1-31",class:"block w-full text-sm border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"},null,8,pe),[[b,a.tanggal_keberangkatan,void 0,{number:!0}]])]),e("div",null,[t[25]||(t[25]=e("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"Kuota",-1)),u(e("input",{"onUpdate:modelValue":o=>a.kuota=o,type:"number",required:"",min:"1",max:"100",placeholder:"40",class:"block w-full text-sm border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"},null,8,ve),[[b,a.kuota,void 0,{number:!0}]])])]),e("div",fe,[e("div",null,[t[26]||(t[26]=e("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"Biaya Tambahan (IDR)",-1)),u(e("input",{"onUpdate:modelValue":o=>a.biaya_tambahan=o,type:"number",min:"0",step:"100000",placeholder:"0",class:"block w-full text-sm border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"},null,8,ke),[[b,a.biaya_tambahan,void 0,{number:!0}]])]),e("div",null,[t[27]||(t[27]=e("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"Preview Tanggal",-1)),e("div",xe,d(S(a)),1)])]),e("div",ye,[t[28]||(t[28]=e("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"Catatan (Opsional)",-1)),u(e("textarea",{"onUpdate:modelValue":o=>a.catatan=o,rows:"2",placeholder:"Contoh: Jadwal libur sekolah, cuaca panas, dll...",class:"block w-full text-sm border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 resize-none"},null,8,he),[[b,a.catatan]])])]),e("button",{type:"button",onClick:o=>j(m),class:"ml-3 p-1 text-red-600 hover:text-red-800"},[...t[29]||(t[29]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,we)])]))),128))]))]),e("div",_e,[e("button",{type:"button",onClick:t[7]||(t[7]=a=>s.$emit("close")),class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}," Batal "),e("button",{type:"submit",disabled:f.value,class:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50"},[f.value?(r(),n("span",Ue,"Menyimpan...")):(r(),n("span",De,d(c.value?"Update":"Simpan"),1))],8,Ve)])],32)])])])])])])):g("",!0)}};export{Be as default};
