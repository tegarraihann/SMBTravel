import{r as v,f as k,g as S,o,w as W,b as e,c as l,i as d,t as i,j as b,v as E,k as C,m as K,F as D,e as T,n as B,p as G,q as F,s as f}from"./app-DuLUwTU_.js";import{_ as Q}from"./AdminLayout-qrwbdid_.js";import"./ApplicationLogo-uq9fm9QF.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-ByflGO8O.js";const X={class:"py-6"},Y={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},Z={key:0,class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6"},ee={class:"bg-white overflow-hidden shadow rounded-lg"},te={class:"p-5"},se={class:"flex items-center"},ae={class:"ml-5 w-0 flex-1"},oe={class:"text-lg font-medium text-gray-900"},le={class:"bg-white overflow-hidden shadow rounded-lg"},ne={class:"p-5"},ie={class:"flex items-center"},de={class:"ml-5 w-0 flex-1"},re={class:"text-lg font-medium text-gray-900"},ue={class:"bg-white overflow-hidden shadow rounded-lg"},ce={class:"p-5"},me={class:"flex items-center"},xe={class:"ml-5 w-0 flex-1"},ge={class:"text-lg font-medium text-gray-900"},ve={class:"bg-white overflow-hidden shadow rounded-lg"},be={class:"p-5"},pe={class:"flex items-center"},fe={class:"ml-5 w-0 flex-1"},he={class:"text-lg font-medium text-gray-900"},ye={class:"bg-white shadow rounded-lg mb-6"},we={class:"p-6"},_e={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},ke={class:"flex items-end"},Ce={class:"flex items-center"},je={class:"bg-white shadow overflow-hidden rounded-lg"},Me={class:"overflow-x-auto"},Se={class:"min-w-full divide-y divide-gray-200"},De={class:"bg-white divide-y divide-gray-200"},Te={class:"px-6 py-4 whitespace-nowrap"},Be={class:"flex items-center"},Fe={class:"text-sm font-medium text-gray-900"},Pe={class:"text-sm text-gray-500"},ze={class:"px-6 py-4 whitespace-nowrap"},Ve={class:"text-sm text-gray-900"},$e={class:"px-6 py-4 whitespace-nowrap"},Ie={class:"text-sm text-gray-900"},Le={key:0,class:"text-xs text-red-600"},Ae={class:"px-6 py-4 whitespace-nowrap"},Ne={class:"text-sm font-medium text-gray-900"},Oe={class:"px-6 py-4 whitespace-nowrap"},Re={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},Ue={class:"flex space-x-2"},He=["onClick"],Je=["onClick"],qe=["onClick"],We=["onClick"],Ee={key:0,class:"bg-white px-4 py-3 border-t border-gray-200 sm:px-6"},Ke={class:"flex items-center justify-between"},Ge={class:"flex-1 flex justify-between sm:hidden"},Qe=["href"],Xe=["href"],Ye={class:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"},Ze={class:"text-sm text-gray-700"},et={class:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px"},tt={key:1,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},st={class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"},at={class:"mt-3"},ot={class:"mb-4"},lt={class:"flex justify-end space-x-3"},nt=["disabled"],it={key:0},dt={key:1},rt={key:2,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},ut={class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"},ct={class:"mt-3"},mt={class:"mb-4"},xt={class:"flex justify-end space-x-3"},gt=["disabled"],vt={key:0},bt={key:1},_t={__name:"Index",props:{installments:Object,statistics:Object,filters:Object},setup(n){const h=n,r=v(!1),y=v(!1),w=v(!1),m=v(null),_=v(null),u=k({status:h.filters?.status||"",search:h.filters?.search||"",overdue:h.filters?.overdue||!1}),x=k({reason:""}),g=k({reason:""}),P=a=>new Intl.NumberFormat("id-ID").format(a),z=a=>new Date(a).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"}),V=a=>({pending:"bg-yellow-100 text-yellow-800",paid:"bg-green-100 text-green-800",overdue:"bg-red-100 text-red-800",waived:"bg-gray-100 text-gray-600"})[a]||"bg-gray-100 text-gray-600",$=a=>({pending:"Menunggu",paid:"Sudah Dibayar",overdue:"Terlambat",waived:"Dibebaskan"})[a]||a,I=(a,t)=>t==="pending"&&new Date(a)<new Date,L=a=>{const t=new Date,s=new Date(a),c=Math.abs(t-s);return Math.ceil(c/(1e3*60*60*24))},p=()=>{f.get("/admin/installments",u,{preserveState:!0,preserveScroll:!0})},A=()=>{_.value&&clearTimeout(_.value),_.value=setTimeout(()=>{p()},500)},N=()=>{u.status="",u.search="",u.overdue=!1,p()},O=a=>{confirm("Apakah Anda yakin ingin menyetujui pembayaran ini?")&&(r.value=!0,f.post(`/admin/installments/${a.id}/approve`,{},{onFinish:()=>{r.value=!1}}))},R=a=>{m.value=a,x.reason="",y.value=!0},j=()=>{y.value=!1,m.value=null,x.reason=""},U=()=>{m.value&&(r.value=!0,f.post(`/admin/installments/${m.value.id}/reject`,{reason:x.reason},{onSuccess:()=>{j()},onFinish:()=>{r.value=!1}}))},H=a=>{m.value=a,g.reason="",w.value=!0},M=()=>{w.value=!1,m.value=null,g.reason=""},J=()=>{m.value&&(r.value=!0,f.post(`/admin/installments/${m.value.id}/waive`,{reason:g.reason},{onSuccess:()=>{M()},onFinish:()=>{r.value=!1}}))},q=a=>{window.open(`/admin/installments/${a}/download`,"_blank")};return(a,t)=>(o(),S(Q,null,{default:W(()=>[e("div",X,[e("div",Y,[t[24]||(t[24]=e("div",{class:"mb-6"},[e("h1",{class:"text-2xl font-bold text-gray-900"},"Manajemen Cicilan Program Talangan"),e("p",{class:"text-gray-600 mt-2"},"Kelola pembayaran cicilan jamaah program talangan")],-1)),n.statistics?(o(),l("div",Z,[e("div",ee,[e("div",te,[e("div",se,[t[6]||(t[6]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-6 w-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1)),e("div",ae,[e("dl",null,[t[5]||(t[5]=e("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Total Cicilan",-1)),e("dd",oe,i(n.statistics.total_installments),1)])])])])]),e("div",le,[e("div",ne,[e("div",ie,[t[8]||(t[8]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-6 w-6 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",de,[e("dl",null,[t[7]||(t[7]=e("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Sudah Dibayar",-1)),e("dd",re,i(n.statistics.paid_installments),1)])])])])]),e("div",ue,[e("div",ce,[e("div",me,[t[10]||(t[10]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-6 w-6 text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",xe,[e("dl",null,[t[9]||(t[9]=e("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Menunggu",-1)),e("dd",ge,i(n.statistics.pending_installments),1)])])])])]),e("div",ve,[e("div",be,[e("div",pe,[t[12]||(t[12]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-6 w-6 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16c-.77.833.192 2.5 1.732 2.5z"})])],-1)),e("div",fe,[e("dl",null,[t[11]||(t[11]=e("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Terlambat",-1)),e("dd",he,i(n.statistics.overdue_installments),1)])])])])])])):d("",!0),e("div",ye,[e("div",we,[t[17]||(t[17]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Filter & Pencarian",-1)),e("div",_e,[e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Status",-1)),b(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>u.status=s),onChange:p,class:"block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"},[...t[13]||(t[13]=[e("option",{value:""},"Semua Status",-1),e("option",{value:"pending"},"Menunggu",-1),e("option",{value:"paid"},"Sudah Dibayar",-1),e("option",{value:"overdue"},"Terlambat",-1),e("option",{value:"waived"},"Dibebaskan",-1)])],544),[[E,u.status]])]),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Cari Jamaah",-1)),b(e("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=s=>u.search=s),onInput:A,placeholder:"Nama jamaah...",class:"block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"},null,544),[[C,u.search]])]),e("div",ke,[e("label",Ce,[b(e("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=s=>u.overdue=s),onChange:p,class:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"},null,544),[[K,u.overdue]]),t[16]||(t[16]=e("span",{class:"ml-2 text-sm text-gray-700"},"Hanya Terlambat",-1))])]),e("div",{class:"flex items-end"},[e("button",{onClick:N,class:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}," Reset Filter ")])])])]),e("div",je,[t[19]||(t[19]=e("div",{class:"p-6 border-b border-gray-200"},[e("h3",{class:"text-lg font-medium text-gray-900"},"Daftar Cicilan")],-1)),e("div",Me,[e("table",Se,[t[18]||(t[18]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Jamaah "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Cicilan "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Jatuh Tempo "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Jumlah "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Aksi ")])],-1)),e("tbody",De,[(o(!0),l(D,null,T(n.installments.data,s=>(o(),l("tr",{key:s.id},[e("td",Te,[e("div",Be,[e("div",null,[e("div",Fe,i(s.jamaah_profile?.nama_lengkap_bin_binti),1),e("div",Pe,i(s.jamaah_profile?.user?.email),1)])])]),e("td",ze,[e("div",Ve," Cicilan ke-"+i(s.installment_number),1)]),e("td",$e,[e("div",Ie,i(z(s.due_date)),1),I(s.due_date,s.status)?(o(),l("div",Le," Terlambat "+i(L(s.due_date))+" hari ",1)):d("",!0)]),e("td",Ae,[e("div",Ne," Rp "+i(P(s.amount)),1)]),e("td",Oe,[e("span",{class:B([V(s.status),"inline-flex px-2 py-1 text-xs font-semibold rounded-full"])},i($(s.status)),3)]),e("td",Re,[e("div",Ue,[s.status==="paid"?(o(),l("button",{key:0,onClick:c=>O(s),class:"text-green-600 hover:text-green-900"}," Setujui ",8,He)):d("",!0),s.status==="paid"?(o(),l("button",{key:1,onClick:c=>R(s),class:"text-red-600 hover:text-red-900"}," Tolak ",8,Je)):d("",!0),s.status!=="paid"&&s.status!=="waived"?(o(),l("button",{key:2,onClick:c=>H(s),class:"text-blue-600 hover:text-blue-900"}," Bebaskan ",8,qe)):d("",!0),s.payment_proof?(o(),l("button",{key:3,onClick:c=>q(s.id),class:"text-purple-600 hover:text-purple-900"}," Bukti ",8,We)):d("",!0)])])]))),128))])])]),n.installments.links?(o(),l("div",Ee,[e("div",Ke,[e("div",Ge,[n.installments.prev_page_url?(o(),l("a",{key:0,href:n.installments.prev_page_url,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"}," Previous ",8,Qe)):d("",!0),n.installments.next_page_url?(o(),l("a",{key:1,href:n.installments.next_page_url,class:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"}," Next ",8,Xe)):d("",!0)]),e("div",Ye,[e("div",null,[e("p",Ze," Showing "+i(n.installments.from)+" to "+i(n.installments.to)+" of "+i(n.installments.total)+" results ",1)]),e("div",null,[e("nav",et,[(o(!0),l(D,null,T(n.installments.links,(s,c)=>(o(),S(G(s.url?"a":"span"),{key:c,href:s.url,class:B(["relative inline-flex items-center px-2 py-2 border text-sm font-medium",s.active?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50",c===0?"rounded-l-md":"",c===n.installments.links.length-1?"rounded-r-md":""]),innerHTML:s.label},null,8,["href","class","innerHTML"]))),128))])])])])])):d("",!0)]),y.value?(o(),l("div",tt,[e("div",st,[e("div",at,[t[21]||(t[21]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"}," Tolak Pembayaran Cicilan ",-1)),e("form",{onSubmit:F(U,["prevent"])},[e("div",ot,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Alasan Penolakan * ",-1)),b(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=s=>x.reason=s),rows:"4",class:"block w-full border-gray-300 rounded-md shadow-sm focus:ring-red-500 focus:border-red-500",placeholder:"Masukkan alasan penolakan...",required:""},null,512),[[C,x.reason]])]),e("div",lt,[e("button",{type:"button",onClick:j,class:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200"}," Batal "),e("button",{type:"submit",disabled:r.value,class:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 disabled:opacity-50"},[r.value?(o(),l("span",it,"Memproses...")):(o(),l("span",dt,"Tolak"))],8,nt)])],32)])])])):d("",!0),w.value?(o(),l("div",rt,[e("div",ut,[e("div",ct,[t[23]||(t[23]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"}," Bebaskan Pembayaran Cicilan ",-1)),e("form",{onSubmit:F(J,["prevent"])},[e("div",mt,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Alasan Pembebasan * ",-1)),b(e("textarea",{"onUpdate:modelValue":t[4]||(t[4]=s=>g.reason=s),rows:"4",class:"block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Masukkan alasan pembebasan...",required:""},null,512),[[C,g.reason]])]),e("div",xt,[e("button",{type:"button",onClick:M,class:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200"}," Batal "),e("button",{type:"submit",disabled:r.value,class:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50"},[r.value?(o(),l("span",vt,"Memproses...")):(o(),l("span",bt,"Bebaskan"))],8,gt)])],32)])])])):d("",!0)])])]),_:1}))}};export{_t as default};
