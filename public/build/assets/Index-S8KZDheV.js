import{r,g as V,C as b,c as l,o,a as _,u as E,h as z,w as C,b as e,j as D,k as h,d as M,F as f,e as S,t as n,q as J}from"./app-Cbx_-bua.js";import{_ as L}from"./AdminLayout-m-tUBPSK.js";import U from"./PackageFormModal-rWJ1ZSMS.js";import R from"./ScheduleModal-B963oobr.js";import"./ApplicationLogo-DKH-H1_m.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-CizZqq9U.js";const q={class:"py-12"},G={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},K={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},O={class:"p-6 border-b border-gray-200"},Q={class:"flex justify-between items-center"},W={class:"flex space-x-3"},X=["disabled"],Y={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-gray-700",fill:"none",viewBox:"0 0 24 24"},Z={key:1,class:"-ml-1 mr-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},I={class:"overflow-x-auto"},ee={class:"min-w-full divide-y divide-gray-200"},te={class:"bg-white divide-y divide-gray-200"},se={key:1},ae={class:"px-6 py-4 whitespace-nowrap"},oe={class:"text-sm font-medium text-gray-900"},le={class:"text-sm text-gray-500 max-w-xs truncate"},ne={class:"px-6 py-4 whitespace-nowrap"},re={class:"text-sm font-medium text-gray-900"},ie={class:"text-sm text-gray-500"},de={class:"px-6 py-4 whitespace-nowrap"},ce={class:"text-sm text-gray-900"},ue={key:0,class:"text-xs text-gray-500"},xe={class:"px-6 py-4 whitespace-nowrap"},me={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},pe={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},ge={class:"flex items-center justify-end space-x-2"},he=["onClick"],fe=["onClick"],ve=["onClick","disabled"],Se={__name:"Index",setup(ye){const i=r(!0),p=r([]),d=r(!1),u=r(!1),x=r(null),g=r(null);V(()=>{c()});const c=async()=>{try{i.value=!0;const s=await b.get("/api/admin/packages");s.data.success&&(p.value=s.data.data)}catch(s){console.error("Error loading packages:",s)}finally{i.value=!1}},j=()=>{c()},v=()=>{x.value=null,d.value=!0},P=s=>{x.value={...s},d.value=!0},y=()=>{d.value=!1,x.value=null},B=()=>{y(),c()},$=s=>{g.value=s,u.value=!0},w=()=>{u.value=!1,g.value=null},A=()=>{w(),c()},N=async s=>{if(s.jamaah_count>0){alert("Tidak dapat menghapus paket yang sudah memiliki jamaah terdaftar");return}if(confirm(`Apakah Anda yakin ingin menghapus paket "${s.nama_paket}"?`))try{(await b.delete(`/api/admin/packages/${s.id}`)).data.success&&c()}catch(t){console.error("Error deleting package:",t),alert("Gagal menghapus paket")}},T=s=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(s),H=s=>new Date(s).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"}),F=s=>s.available_schedules?s.available_schedules.filter(t=>t.status==="tersedia"&&new Date(t.tanggal_lengkap)>=new Date).length:0,k=s=>s.available_schedules&&s.available_schedules.filter(a=>a.status==="tersedia"&&new Date(a.tanggal_lengkap)>=new Date).sort((a,m)=>new Date(a.tanggal_lengkap)-new Date(m.tanggal_lengkap))[0]||null;return(s,t)=>(o(),l(f,null,[_(E(z),{title:"Master Data Paket Umroh"}),_(L,null,{header:C(()=>[...t[0]||(t[0]=[e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Master Data Paket Umroh ",-1)])]),default:C(()=>[e("div",q,[e("div",G,[e("div",K,[e("div",O,[e("div",Q,[t[5]||(t[5]=e("div",null,[e("h3",{class:"text-lg font-medium text-gray-900"},"Daftar Paket Umroh"),e("p",{class:"mt-1 text-sm text-gray-600"}," Kelola paket umroh, harga, jadwal, dan fasilitas ")],-1)),e("div",W,[e("button",{onClick:j,disabled:i.value,class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50"},[i.value?(o(),l("svg",Y,[...t[1]||(t[1]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(o(),l("svg",Z,[...t[2]||(t[2]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])])),t[3]||(t[3]=M(" Refresh ",-1))],8,X),e("button",{onClick:v,class:"inline-flex items-center px-4 py-2 bg-blue-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-blue-700 focus:bg-blue-700 active:bg-blue-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition ease-in-out duration-150"},[...t[4]||(t[4]=[e("svg",{class:"-ml-1 mr-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),M(" Tambah Paket ",-1)])])])])]),e("div",I,[e("table",ee,[t[10]||(t[10]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Paket "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Harga & Durasi "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Jadwal Tersedia "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Jamaah Terdaftar "),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," Aksi ")])],-1)),e("tbody",te,[i.value?(o(),l(f,{key:0},S(3,a=>e("tr",{key:`loading-${a}`},[...t[6]||(t[6]=[e("td",{class:"px-6 py-4 whitespace-nowrap",colspan:"6"},[e("div",{class:"animate-pulse flex space-x-4"},[e("div",{class:"rounded-full bg-gray-300 h-10 w-10"}),e("div",{class:"flex-1 space-y-2 py-1"},[e("div",{class:"h-4 bg-gray-300 rounded w-3/4"}),e("div",{class:"h-4 bg-gray-300 rounded w-1/2"})])])],-1)])])),64)):p.value.length===0?(o(),l("tr",se,[e("td",{colspan:"6",class:"px-6 py-4 text-center text-gray-500"},[e("div",{class:"flex flex-col items-center justify-center py-8"},[t[7]||(t[7]=e("svg",{class:"h-12 w-12 text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})],-1)),t[8]||(t[8]=e("p",{class:"text-lg font-medium text-gray-900 mb-2"},"Belum ada paket",-1)),t[9]||(t[9]=e("p",{class:"text-gray-500 mb-4"},"Mulai dengan membuat paket umroh pertama",-1)),e("button",{onClick:v,class:"inline-flex items-center px-4 py-2 bg-blue-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-blue-700"}," Tambah Paket Pertama ")])])])):(o(!0),l(f,{key:2},S(p.value,a=>(o(),l("tr",{key:a.id,class:"hover:bg-gray-50"},[e("td",ae,[e("div",null,[e("div",oe,n(a.nama_paket),1),e("div",le,n(a.deskripsi),1)])]),e("td",ne,[e("div",re,n(T(a.harga)),1),e("div",ie,n(a.durasi_hari)+" hari",1)]),e("td",de,[e("div",ce,n(F(a))+" jadwal ",1),k(a)?(o(),l("div",ue," Terdekat: "+n(H(k(a).tanggal_lengkap)),1)):h("",!0)]),e("td",xe,[e("span",{class:J([{"bg-green-100 text-green-800":a.status==="aktif","bg-red-100 text-red-800":a.status==="non_aktif"},"inline-flex px-2 text-xs leading-5 font-semibold rounded-full"])},n(a.status==="aktif"?"Aktif":"Non Aktif"),3)]),e("td",me,n(a.jamaah_count||0)+" jamaah ",1),e("td",pe,[e("div",ge,[e("button",{onClick:m=>$(a),class:"text-blue-600 hover:text-blue-900 text-xs"}," Jadwal ",8,he),e("button",{onClick:m=>P(a),class:"text-indigo-600 hover:text-indigo-900 text-xs"}," Edit ",8,fe),e("button",{onClick:m=>N(a),class:"text-red-600 hover:text-red-900 text-xs",disabled:a.jamaah_count>0}," Hapus ",8,ve)])])]))),128))])])])])])]),d.value?(o(),D(U,{key:0,show:d.value,"package-data":x.value,onClose:y,onSave:B},null,8,["show","package-data"])):h("",!0),u.value?(o(),D(R,{key:1,show:u.value,"package-data":g.value,onClose:w,onSave:A},null,8,["show","package-data"])):h("",!0)]),_:1})],64))}};export{Se as default};
