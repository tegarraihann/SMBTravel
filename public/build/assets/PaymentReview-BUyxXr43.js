import{r as h,z as p,c as n,o as l,a as x,u as y,h as S,w as f,b as t,i as _,t as i,F as w,e as V,l as R,d as H,n as b,s as r}from"./app-DuLUwTU_.js";import{_ as N}from"./AdminLayout-qrwbdid_.js";import"./ApplicationLogo-uq9fm9QF.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-ByflGO8O.js";const M={class:"py-12"},$={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},E={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},I={class:"bg-white overflow-hidden shadow rounded-lg"},J={class:"p-5"},F={class:"flex items-center"},j={class:"ml-5 w-0 flex-1"},G={class:"text-lg font-medium text-gray-900"},U={class:"bg-white overflow-hidden shadow rounded-lg"},q={class:"p-5"},K={class:"flex items-center"},O={class:"ml-5 w-0 flex-1"},Q={class:"text-lg font-medium text-gray-900"},W={class:"bg-white overflow-hidden shadow rounded-lg"},X={class:"p-5"},Y={class:"flex items-center"},Z={class:"ml-5 w-0 flex-1"},tt={class:"text-lg font-medium text-gray-900"},et={class:"bg-white overflow-hidden shadow rounded-lg"},st={class:"p-5"},at={class:"flex items-center"},it={class:"ml-5 w-0 flex-1"},nt={class:"text-lg font-medium text-gray-900"},lt={class:"bg-white shadow rounded-lg"},ot={class:"px-4 py-5 sm:p-6"},rt={class:"mt-8 overflow-x-auto"},dt={class:"min-w-full divide-y divide-gray-200"},ct={class:"bg-white divide-y divide-gray-200"},mt={key:0},ut={class:"px-6 py-4 whitespace-nowrap"},pt={class:"flex items-center"},xt={class:"flex-shrink-0 h-10 w-10"},ft={class:"h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center"},_t={class:"text-sm font-medium text-gray-700"},vt={class:"ml-4"},gt={class:"text-sm font-medium"},ht={class:"text-sm text-gray-500"},yt={class:"px-6 py-4 whitespace-nowrap"},wt={class:"text-sm font-medium text-gray-900"},bt={class:"text-sm text-gray-500"},kt={class:"px-6 py-4 whitespace-nowrap"},Ct={key:0},At=["onClick"],Dt={key:1,class:"text-sm text-gray-500"},Bt={class:"px-6 py-4 whitespace-nowrap"},Pt={class:"px-6 py-4 whitespace-nowrap"},zt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Lt={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},Tt={class:"flex flex-col space-y-1"},St=["onClick"],Vt={key:0,class:"flex space-x-2"},Rt=["onClick"],Ht=["onClick"],Nt={key:1,class:"text-xs text-green-600"},Mt={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},$t={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},Et={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},It={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},Jt={class:"sm:flex sm:items-start"},Ft={class:"mt-3 text-center sm:mt-0 sm:text-left w-full"},jt={class:"text-lg leading-6 font-medium text-gray-900 mb-4"},Gt={class:"mt-2"},Ut=["src"],Xt={__name:"PaymentReview",props:{jamaahList:{type:Array,default:()=>[]}},setup(d){const m=d,u=h(null),c=h(null),k=p(()=>m.jamaahList.filter(a=>a.can_admin_approve).length),C=p(()=>m.jamaahList.filter(a=>a.payment_approved_by_admin).length),A=p(()=>m.jamaahList.reduce((a,e)=>a+(e.dp_paid||0),0)),v=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(a),D=a=>new Date(a).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),B=a=>a.payment_approved_by_admin?"Disetujui Admin":a.bukti_transfer?"Perlu Review":"Belum Upload",P=a=>{u.value=a,c.value=a.bukti_transfer},g=()=>{u.value=null,c.value=null},z=a=>{r.visit(route("admin.payment.review.show",a.id))},L=a=>{confirm("Apakah Anda yakin pembayaran ini valid dan ingin disetujui?")&&r.patch(route("admin.jamaah.approve.payment",a),{},{onSuccess:()=>{r.reload({only:["jamaahList"]})},onError:e=>{alert("Error: "+(e.message||"Gagal approve pembayaran"))}})},T=a=>{confirm("Apakah Anda yakin ingin menolak pembayaran ini? Jamaah akan diminta upload ulang bukti transfer.")&&r.patch(route("admin.jamaah.reject.payment",a),{},{onSuccess:()=>{r.reload({only:["jamaahList"]})},onError:e=>{alert("Error: "+(e.message||"Gagal reject pembayaran"))}})};return(a,e)=>(l(),n(w,null,[x(y(S),{title:"Review Pembayaran - Admin"}),x(N,null,{header:f(()=>[...e[0]||(e[0]=[t("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Review Pembayaran Jamaah ",-1)])]),default:f(()=>[t("div",M,[t("div",$,[t("div",E,[t("div",I,[t("div",J,[t("div",F,[e[2]||(e[2]=t("div",{class:"flex-shrink-0"},[t("div",{class:"w-8 h-8 bg-blue-500 rounded-lg flex items-center justify-center"},[t("svg",{class:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{d:"M4 4a2 2 0 00-2 2v4a2 2 0 002 2V6h10a2 2 0 00-2-2H4zm2 6a2 2 0 012-2h8a2 2 0 012 2v4a2 2 0 01-2 2H8a2 2 0 01-2-2v-4zm6 4a2 2 0 100-4 2 2 0 000 4z"})])])],-1)),t("div",j,[t("dl",null,[e[1]||(e[1]=t("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Total Pembayaran",-1)),t("dd",G,i(d.jamaahList.length),1)])])])])]),t("div",U,[t("div",q,[t("div",K,[e[4]||(e[4]=t("div",{class:"flex-shrink-0"},[t("div",{class:"w-8 h-8 bg-yellow-500 rounded-lg flex items-center justify-center"},[t("svg",{class:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M10 2a4 4 0 00-4 4v1H5a1 1 0 00-.994.89l-1 9A1 1 0 004 18h12a1 1 0 00.994-1.11l-1-9A1 1 0 0015 7h-1V6a4 4 0 00-4-4zm2 5V6a2 2 0 10-4 0v1h4zm-6 3a1 1 0 112 0 1 1 0 01-2 0zm7-1a1 1 0 100 2 1 1 0 000-2z","clip-rule":"evenodd"})])])],-1)),t("div",O,[t("dl",null,[e[3]||(e[3]=t("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Perlu Review Admin",-1)),t("dd",Q,i(k.value),1)])])])])]),t("div",W,[t("div",X,[t("div",Y,[e[6]||(e[6]=t("div",{class:"flex-shrink-0"},[t("div",{class:"w-8 h-8 bg-green-500 rounded-lg flex items-center justify-center"},[t("svg",{class:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})])])],-1)),t("div",Z,[t("dl",null,[e[5]||(e[5]=t("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Sudah Disetujui",-1)),t("dd",tt,i(C.value),1)])])])])]),t("div",et,[t("div",st,[t("div",at,[e[8]||(e[8]=t("div",{class:"flex-shrink-0"},[t("div",{class:"w-8 h-8 bg-purple-500 rounded-lg flex items-center justify-center"},[t("svg",{class:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{d:"M4 4a2 2 0 00-2 2v4a2 2 0 002 2V6h10a2 2 0 00-2-2H4zm2 6a2 2 0 012-2h8a2 2 0 012 2v4a2 2 0 01-2 2H8a2 2 0 01-2-2v-4zm6 4a2 2 0 100-4 2 2 0 000 4z"})])])],-1)),t("div",it,[t("dl",null,[e[7]||(e[7]=t("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Total Nilai DP",-1)),t("dd",nt,i(v(A.value)),1)])])])])])]),t("div",lt,[t("div",ot,[e[11]||(e[11]=t("div",{class:"sm:flex sm:items-center"},[t("div",{class:"sm:flex-auto"},[t("h3",{class:"text-lg font-semibold text-gray-900"},"Daftar Pembayaran untuk Review"),t("p",{class:"mt-2 text-sm text-gray-700"},"Review dan approve bukti transfer yang diupload jamaah.")])],-1)),t("div",rt,[t("table",dt,[e[10]||(e[10]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Jamaah"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Nominal DP"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Bukti Transfer"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status CS"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status Admin"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Tanggal Upload"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Aksi")])],-1)),t("tbody",ct,[d.jamaahList.length===0?(l(),n("tr",mt,[...e[9]||(e[9]=[t("td",{colspan:"7",class:"px-6 py-8 text-center text-gray-500"},[t("div",{class:"flex flex-col items-center"},[t("svg",{class:"w-12 h-12 text-gray-300 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1",d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})]),t("p",null,"Belum ada pembayaran untuk direview")])],-1)])])):_("",!0),(l(!0),n(w,null,V(d.jamaahList,s=>(l(),n("tr",{key:s.id,class:"hover:bg-gray-50"},[t("td",ut,[t("div",pt,[t("div",xt,[t("div",ft,[t("span",_t,i(s.nama_lengkap?s.nama_lengkap.split(" ").map(o=>o[0]).join("").slice(0,2):"??"),1)])]),t("div",vt,[t("div",gt,[x(y(R),{href:a.route("admin.payment.review.show",s.id),class:"text-gray-900 hover:text-blue-600 transition-colors"},{default:f(()=>[H(i(s.nama_lengkap||"Nama tidak tersedia"),1)]),_:2},1032,["href"])]),t("div",ht,i(s.email),1)])])]),t("td",yt,[t("div",wt,i(v(s.dp_paid)),1),t("div",bt,"Paket ID: "+i(s.paket_id),1)]),t("td",kt,[s.bukti_transfer?(l(),n("div",Ct,[t("button",{onClick:o=>P(s),class:"text-blue-600 hover:text-blue-900 text-sm"}," Lihat Bukti Transfer ",8,At)])):(l(),n("div",Dt,"Belum upload"))]),t("td",Bt,[t("span",{class:b([{"bg-green-100 text-green-800":s.data_approved_by_cs,"bg-gray-100 text-gray-800":!s.data_approved_by_cs},"inline-flex px-2 py-1 text-xs font-semibold rounded-full"])},i(s.data_approved_by_cs?"Disetujui CS":"Belum Review CS"),3)]),t("td",Pt,[t("span",{class:b([{"bg-green-100 text-green-800":s.payment_approved_by_admin,"bg-yellow-100 text-yellow-800":!s.payment_approved_by_admin&&s.bukti_transfer,"bg-gray-100 text-gray-800":!s.bukti_transfer},"inline-flex px-2 py-1 text-xs font-semibold rounded-full"])},i(B(s)),3)]),t("td",zt,i(s.bukti_transfer?D(s.created_at):"-"),1),t("td",Lt,[t("div",Tt,[t("button",{onClick:o=>z(s),class:"text-blue-600 hover:text-blue-900 text-left"}," Lihat Detail ",8,St),s.can_admin_approve?(l(),n("div",Vt,[t("button",{onClick:o=>L(s.id),class:"text-green-600 hover:text-green-900 text-xs"}," ✓ Approve ",8,Rt),t("button",{onClick:o=>T(s.id),class:"text-red-600 hover:text-red-900 text-xs"}," ✗ Tolak ",8,Ht)])):s.payment_approved_by_admin?(l(),n("div",Nt," ✓ Sudah Disetujui ")):_("",!0)])])]))),128))])])])])])])]),c.value?(l(),n("div",Mt,[t("div",$t,[t("div",{class:"fixed inset-0 transition-opacity",onClick:g},[...e[12]||(e[12]=[t("div",{class:"absolute inset-0 bg-gray-500 opacity-75"},null,-1)])]),t("div",Et,[t("div",It,[t("div",Jt,[t("div",Ft,[t("h3",jt," Bukti Transfer - "+i(u.value?.nama_lengkap),1),t("div",Gt,[t("img",{src:`/storage/${c.value}`,alt:"Bukti Transfer",class:"max-w-full h-auto rounded-lg"},null,8,Ut)])])])]),t("div",{class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},[t("button",{type:"button",onClick:g,class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm"}," Tutup ")])])])])):_("",!0)]),_:1})],64))}};export{Xt as default};
